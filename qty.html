<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Inventory Summary</title>
  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    alert("I'm here");
    alert("I'm here 2");
     // Load the Google Sheets API client library
     gapi.load('client', function() {
   // Authenticate the client with the Google Sheets API using OAuth 2.0
   // ...
    alert("I'm here 3");
   // Retrieve the data from the "Jackson Inventory" sheet
     gapi.client.sheets.spreadsheets.values.get({
     spreadsheetId: '1ls6zFkH8epBpvfHcycXia4_M0irRBmj9z00r7LOMW6E',
     range: 'A:C'
   }).then(function(response) {
     // Process the data to get the unique barcodes and calculate the quantity for each item
     alert("I'm here 4");
     var data = response.result.values;
     var items = {};
         
    alert("Wow! this is amazing");
     data.forEach(function(row) {
       var barcode = row[0];
       var name = row[1];
       var qty = Number(row[2]);
       if (items[barcode]) {
         items[barcode].qty += qty;
       } else {
         items[barcode] = {
           name: name,
           qty: qty
         };
       }
     });

     // Display the data on the screen
     alert("I'm here 5");
     var table = document.createElement('table');
     var header = table.createTHead();
     var row = header.insertRow(0);
     row.insertCell(0).innerHTML = 'Barcode';
     row.insertCell(1).innerHTML = 'Product Name';
     row.insertCell(2).innerHTML = 'Qty';
     var body = table.createTBody();
     Object.keys(items).forEach(function(barcode) {
       row = body.insertRow();
       row.insertCell(0).innerHTML = barcode;
       row.insertCell(1).innerHTML = items[barcode].name;
       row.insertCell(2).innerHTML = items[barcode].qty;
     });
     document.body.appendChild(table);
   }, function(reason) {
    alert("I'm here errrroooorrr");
     console.error('Error: ' + reason.result.error.message);
   });
 });

  </script>
</head>
<body>
  <button onclick="myFunction()">Show PopUp</button>
  <h1>Inventory Summaryee</h1>
  <div id="table-container"></div>
</body>
</html>
